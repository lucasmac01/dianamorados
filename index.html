<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gatinho ‚ù§Ô∏è Gatinha</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root { --accent: #f87171; }
    body { background: #f9fafb; }
    .pop { animation: pop .3s ease-out; }
    @keyframes pop { 0%{transform:scale(.96);opacity:.7} 60%{transform:scale(1.04);opacity:1} 100%{transform:scale(1);} }
    .pulse { animation: pulse 1.5s ease-in-out infinite; }
    @keyframes pulse { 0%,100%{transform:scale(1);opacity:1;} 50%{transform:scale(1.15);opacity:0.85;} }
    .soft { box-shadow: 0 2px 10px rgba(0,0,0,.05); }
    .card { background:white; border-radius:1.25rem; padding:2.5rem; }
  </style>
</head>
<body class="text-gray-800 antialiased">
  <header class="py-3 text-center bg-[var(--accent)]/20 border-b border-[var(--accent)]/30">
    <div class="text-base font-semibold text-[var(--accent)]">Gatinho ‚ù§Ô∏è Gatinha</div>
  </header>

  <main class="flex flex-col items-center justify-center px-6 pb-12 mt-10">
    <section class="card text-center max-w-md w-full soft">
      <h1 class="text-3xl font-bold text-[var(--accent)]">Nosso Tempo</h1>

      <div class="mt-8 flex flex-col items-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-[var(--accent)] pulse" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 21s-6-4.35-8-8.53C2 9.6 3.6 6 7.14 6c2.02 0 3.19 1.12 3.66 2.05C11.47 7.12 12.64 6 14.66 6c3.54 0 5.14 3.6 3.84 6.47C18 16.65 12 21 12 21z"/></svg>
        <p class="mt-5 text-lg text-gray-700">Juntos h√°</p>
        <div class="mt-1 flex items-baseline gap-2">
          <span id="totalDays" class="text-7xl font-extrabold text-[var(--accent)] pop">‚Äî</span>
          <span class="text-lg font-semibold text-[var(--accent)]/90">dias</span>
        </div>
        <p id="sinceDate" class="mt-2 text-xs text-gray-400">Desde 15/02/2025</p>
      </div>
    </section>

    <section class="card mt-8 text-center max-w-md w-full soft">
      <h2 class="text-lg font-semibold text-gray-900">Cart√£o + Brinde do m√™s</h2>
      <p id="redeemStatus" class="mt-1 text-xs text-gray-500">Verificando‚Ä¶</p>

      <button id="btnRedeem" class="mt-6 w-full rounded-full py-3 text-sm font-semibold transition focus:outline-none focus:ring-2 focus:ring-offset-2 shadow-sm">
        Resgatar no dia 15
      </button>

      <div id="giftArea" class="mt-6 hidden">
        <div class="rounded-xl border p-4">
          <p id="giftMessage" class="text-gray-700"></p>
          <p class="mt-2 text-xs uppercase tracking-wide text-gray-500">Brinde</p>
          <p id="giftCode" class="mt-1 font-mono text-sm text-gray-900 select-all">‚Äî</p>
        </div>
      </div>
    </section>

    <footer class="mt-10 text-xs text-gray-400 text-center">
      Feito com <span class="text-[var(--accent)]">‚ù§</span> para celebrar o amor
    </footer>
  </main>

  <script>
    const START_DATE_ISO = '2025-02-15';
    const LS_KEYS = { lastGift: 'gift_lastRedeem' };

    function getTodayBR(){
      const parts = new Intl.DateTimeFormat('pt-BR',{timeZone:'America/Sao_Paulo',day:'2-digit',month:'2-digit',year:'numeric'}).formatToParts(new Date());
      const m = Object.fromEntries(parts.map(p=>[p.type,p.value]));
      return new Date(+m.year, +m.month-1, +m.day);
    }
    function parseISODateOnly(iso){ const [Y,M,D]=iso.split('-').map(Number); return new Date(Y,M-1,D); }
    function diffDays(a,b){ return Math.floor((b-a)/(24*60*60*1000)); }
    const toYYYYMM = d => `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}`;

    const el = {
      totalDays: document.getElementById('totalDays'),
      sinceDate: document.getElementById('sinceDate'),
      btn: document.getElementById('btnRedeem'),
      status: document.getElementById('redeemStatus'),
      giftArea: document.getElementById('giftArea'),
      giftMessage: document.getElementById('giftMessage'),
      giftCode: document.getElementById('giftCode'),
    };

    function updateCounter(){
      const today = getTodayBR();
      const start = parseISODateOnly(START_DATE_ISO);
      const total = diffDays(start,today);
      el.totalDays.textContent = total;
      el.totalDays.classList.remove('pop'); void el.totalDays.offsetWidth; el.totalDays.classList.add('pop');
    }

    function canRedeemToday(){
      const today = getTodayBR();
      if(today.getDate() !== 15) return { ok:false, reason:'not15' };
      const currentYM = toYYYYMM(today);
      const last = localStorage.getItem(LS_KEYS.lastGift)||'';
      if(last === currentYM) return { ok:false, reason:'already' };
      return { ok:true };
    }

    function updateButton(){
      const av = canRedeemToday();
      const btn = el.btn;
      if(av.ok){
        btn.disabled = false;
        btn.className = 'mt-6 w-full rounded-full py-3 text-sm font-semibold bg-emerald-600 hover:bg-emerald-700 text-white shadow-md focus:outline-none focus:ring-2 focus:ring-emerald-400';
        btn.textContent = 'üéÅ Resgatar agora';
        el.status.textContent = 'Dispon√≠vel hoje (dia 15)';
      } else {
        btn.disabled = true;
        btn.className = 'mt-6 w-full rounded-full py-3 text-sm font-semibold bg-[var(--accent)] text-white opacity-90 shadow-md cursor-not-allowed';
        btn.textContent = 'üéÅ Resgatar no dia 15';
        const t = getTodayBR();
        el.status.textContent = av.reason==='already' ? 'J√° resgatado ‚Äî libera na virada do m√™s' : `Hoje √© ${String(t.getDate()).padStart(2,'0')}/${String(t.getMonth()+1).padStart(2,'0')}`;
      }
    }

    function randomGift(){
      const msgs = ['Um passeio juntos','Caf√© da tarde a dois','Filme e pipoca','Jantar rom√¢ntico em casa'];
      const code = 'BRINDE-' + Math.random().toString(36).slice(2,8).toUpperCase();
      return { text: msgs[Math.floor(Math.random()*msgs.length)], code };
    }

    function redeem(){
      const av = canRedeemToday();
      if(!av.ok) return;
      localStorage.setItem(LS_KEYS.lastGift, toYYYYMM(getTodayBR()));
      const g = randomGift();
      el.giftMessage.textContent = g.text;
      el.giftCode.textContent = g.code;
      el.giftArea.classList.remove('hidden');
      updateButton();
    }

    document.getElementById('btnRedeem').addEventListener('click', redeem);
    (function init(){ updateCounter(); updateButton(); })();
  </script>
</body>
</html>
